//  code original réalisé par : hametsu21 http://www.codes-sources.com/auteur/HAMETSU21/612716.aspx//adapté aux besoins de GaiaMundi par H.Paris hpdb@wanadoo.fr if(!document.getElementById) document.getElementById=function (id) { return eval("document.all."+id); } if(document.all) { document.getElementsByName=function (name) { var el=document.all,result=new Array(),j=0; for(var i=0;i<el.length;i++) if(el[i].name.toLowerCase()==name.toLowerCase()) result[j++]=el[i]; return result; }} if(!document.getElementsByTagName) document.getElementsByTagName=function (tagName) { var el=document.all,result=new Array(),j=0; for(var i=0;i<el.length;i++) if(el[i].tagName.toLowerCase()==tagName.toLowerCase()) result[j++]=el[i]; return result; }  //POSITION du CURSEUR trouvé sur http://blog.crondesign.com/2009/11/getset-caret-cursor-position-in-iframe.html //before the save: var iframename="" function CursorBefore(){iframename=document.getElementsByTagName('iframe')[0].idinsertAtCursor(iframename,'<img src="images/marker-autosave.gif" id="caret" />', 0); //change 0 to 1 if you want the user's selection to be replaced by the img} function insertAtCursor(iframename, text, replaceContents) {       if(replaceContents==null){replaceContents=false;}      if(!replaceContents){//collapse selection:         var sel=document.getElementById(iframename).contentWindow.getSelection()         sel.collapseToStart()      }      document.getElementById(iframename).contentWindow.document.execCommand('insertHTML', false, text);}; //after the save:  function CursorReset(){resetCaret(iframename);}function resetCaret(iframename){      var iframe=document.getElementById(iframename).contentWindow      var referenceNode = iframe.document.getElementById("caret");      if(referenceNode){         var sel=document.getElementById(iframename).contentWindow.getSelection()         //alert(sel.focusNode)              if(sel.focusNode){//firefox:  var range=sel.getRangeAt(0);         }else{//chrome:  var range=iframe.document.createRange()         }      range.selectNode(referenceNode);      range.deleteContents();      }} // FIN DE POSITION DU CURSEUR   												function CoucheNappe(){						HyperLien = prompt("entrez le nom de la couche (voir dans le menu Icones X)",""); 							var HyperLien2='<font size="2"><br> Couche '+HyperLien+'<br>'												HyperLien2+='<span style="color: blue; cursor: pointer;" id="'+HyperLien+'" onmousedown="top.affic1(this.id)">afficher</span>'						HyperLien2+=' / <span style="color: blue; cursor: pointer;" id="'+HyperLien+'" onmousedown="top.effac1(this.id)">effacer</span></font><br>'																		return HyperLien2																		}																		function CoucheContour(){						HyperLien = prompt("entrez le Numéro du CONTOUR(de n°1 à ...)",""); 						HyperLienB = prompt("entrez le Nom couche CONTOUR(voir dans le menu Icones X)",""); 						var HyperLien2='<font size="2"><br> Couche '+HyperLienB+'<br>'												HyperLien2+='<span style="color: blue; cursor: pointer;" id="'+(HyperLien-1)+'" onmousedown="top.affic1CONTOUR(this.id)">afficher / effacer</span></font><br>'																		return HyperLien2																		}																																				function lienHyper(){						var textelien= CutgetSelectionHTML()						HyperLien = prompt("entrez l'url(OUVRE NOUVELLE PAGE)",""); 						var HyperLien2='<a href="'+HyperLien+'" style="color:blue" target="_blank" >'+textelien+'</a>'						return HyperLien2						}						function lienHyper2(){						var textelien=CutgetSelectionHTML()						HyperLien = prompt("entrez l'url(MêME PAGE)",""); 						var HyperLien2='<a href="'+HyperLien+'"  style="color:blue" >'+textelien+'</a>'						return HyperLien2						}												function getSelectionHTML()						{						if (window.getSelection)						{						var range = document.getElementsByTagName('iframe')[0].contentWindow.getSelection().getRangeAt(0);						var startContainer = range.startContainer;						var spanNode = startContainer.ownerDocument.createElement("ad");						var docfrag = range.extractContents();						spanNode.appendChild(docfrag);						range.insertNode(spanNode);						return spanNode.innerHTML.replace(/<ad>/g,'').replace(/<\/ad>/g,'');						}						//else if (document.selection && document.selection.createRange) return (document.selection.createRange()).htmlText;						//return null;						}																		function CutgetSelectionHTML()						{						if (window.getSelection)						{						var range = document.getElementsByTagName('iframe')[0].contentWindow.getSelection().getRangeAt(0);						var startContainer = range.startContainer;												var spanNode = startContainer.ownerDocument.createElement("ad");						var docfrag = range.extractContents();						spanNode.appendChild(docfrag);						range.insertNode(spanNode);						var truc=spanNode.innerHTML.replace(/<ad>/g,'').replace(/<\/ad>/g,'');						spanNode.innerHTML=""						return truc						}						//else if (document.selection && document.selection.createRange) return (document.selection.createRange()).htmlText;						//return null;						}							function Wysiwyg(id, objectId) {    if (!id || !objectId) { 		alert('Wysiwyg.constructor(id, objectId) erreur, deux arguments sont requis'); 		return;	}	var datx=''    var self = this;	    this.id = id;    this.objectId = objectId;    this.frame;    this.height = (window.innerHeight-230)+"px"//'390px'; // Height in px	//alert(parent.document.getElementById("Num0txt").width-40)    this.width =(window.innerWidth-45)+"px"//365+"px"//(parent.document.getElementById("Num0txt").width-40)+"px"//'369px'; // Width in px    this.viewSource = false;    this.path = '../icones/'; // Path whith slash at the end    this.cssFile = '';    this.charset = 'iso-8859-1';    this.editorHtml = '';    this.frameHtml = '';    this.textareaValue = '';	    this.browser = {        'ie': Boolean(document.body.currentStyle),        'gecko' : (navigator.userAgent.toLowerCase().indexOf('gecko') != -1)    };    this.init = function() {        if (document.getElementById && document.createElement && document.designMode && (this.browser.ie || this.browser.gecko)) {            // EDITOR            if (!document.getElementById(this.id)) { 				alert('Wysiwyg ' + this.objectId + ' . init() erreur, l\'element "' + this.id + '" n\'existe pas'); 				return; 			}            this.textareaValue = document.getElementById(this.id).value;            var wysiwyg = document.createElement('div');			            document.getElementById(this.id).parentNode.replaceChild(wysiwyg, document.getElementById(this.id));            wysiwyg.id = this.id + '-wysiwyg';            wysiwyg.innerHTML = this.editorHtml ? this.editorHtml : this.getEditorHtml();            // BUTTONS            var buttons = wysiwyg.getElementsByTagName('td');            for (var i = 0; i < buttons.length; ++i) {                if (buttons[i].className == 'button') {                    buttons[i].id = this.id + '-button-' + i;                    buttons[i].onmouseover = function() { 												this.className = 'button-hover'; 											}                    buttons[i].onmouseout = function() { 												this.className = this.className.replace(/button-hover(\s)?/, 'button'); 											}                    buttons[i].onclick = function(id) { 											return function() { 												this.className = 'button-hover button-click'; 												setTimeout(													function() { 														document.getElementById(id).className = document.getElementById(id).className.replace(/(\s)?button-click/, ''); 													}, 100); 											} 										} 					(buttons[i].id);			   }	            }            // FRAME            if (this.browser.ie)                 this.frame = frames[this.id + '-frame'];            else if (this.browser.gecko)                this.frame = document.getElementById(this.id + '-frame').contentWindow;          //alert(this.id + '-frame')            this.frame.document.designMode = 'on';            this.frame.document.open();            this.frame.document.write(this.frameHtml ? this.frameHtml : this.getFrameHtml());            this.frame.document.close();            insertHtmlFromTextarea();        }							this.execCommand( 'enableObjectResizing', true, '' );							this.execCommand( 'enableInlineTableEditing', true, '' );    };    function lockUrls(s) {        if (self.browser.gecko) { 			return s; 		}        return s.replace(/href=["']([^"']*)["']/g, 'href="wysiwyg://wysiwyg/$1"');    }    function unlockUrls(s) {        if (self.browser.gecko) { 			return s; 		}        return s.replace(/href=["']wysiwyg:\/\/wysiwyg\/([^"']*)["']/g, 'href="$1"');    }    function insertHtmlFromTextarea() {        try { 			self.frame.document.body.innerHTML = lockUrls(self.textareaValue); 		} 		catch (e) { 			setTimeout(insertHtmlFromTextarea, 10); 		}    }	    this.getEditorHtml = function() {        var html = '';        html += '<input type="hidden" id="' + this.id + '" name="' + this.id + '" value="">';		html += '<table class="wysiwyg" cellspacing="0" cellpadding="0" height=' + this.height + ' width="' + this.width + '">';		html += '  <tr>';		html += '  	<td>';		html += '	 <table class="bar" id="' + this.id + '-buttons" cellspacing="0" cellpadding="0">';		html += '	   <tr>';		html += '	   	<td>';		html += '		<table cellspacing="0" cellpadding="0">';		html += '  		  <tr>';		//html += '   	   <td class="button"><img src="' + this.path + '../images/cut.gif" width="13" height="13" alt="Couper" title="Couper (CTRL + X)" onclick="' + this.objectId + '.execCommand(\'cut\')"></td>';        //html += '   	   <td class="button"><img src="' + this.path + '../images/copy.gif" width="13" height="13" alt="Copier" title="Copier (CTRL + C)" onclick="' + this.objectId + '.execCommand(\'Copy\')"></td>';        //html += '   	   <td class="button"><img src="' + this.path + '../images/paste.gif" width="13" height="13" alt="Coller" title="Coller (CTRL + V)" onclick="' + this.objectId + '.execCommand(\'Paste\')"></td>';        //html += '   	   <td><div class="separator"></div></td>';		        html += '   	   <td class="button"><img src="' + this.path + '../images/cut.gif" width="18" height="18" alt="Copier" title="Couper spécial ( stock le segment sélectionné en conservant son code javascript)" onclick="document.getElementById(\'col\').style.visibility=\'visible\';codehtml=CutgetSelectionHTML(\'return htmlici\')"></td>';				        html += '   	   <td class="button"><img src="' + this.path + '../images/copy.gif" width="18" height="18" alt="Copier" title="Copier spécial ( stock le segment sélectionné en conservant son code javascript)" onclick="document.getElementById(\'col\').style.visibility=\'visible\';codehtml=getSelectionHTML(\'return htmlici\')"></td>';        html += '   	   <td class="button"><img id="col" src="' + this.path + '../images/paste.gif" style="visibility:hidden" width="18" height="18" alt="Coller" title="Coller spécial (restitue le segment copié avec son code javascript)" onclick="' + this.objectId + '.execCommand(\'insertHTML\',codehtml)"></td>';		        html += '    	   <td><div class="separator"></div></td>';						html += '   	   <td class="button"><img src="' + this.path + '../images/undo.gif" width="13" height="13" alt="Annuler vers l\'arrière" title="Annuler vers l\'arrière" onclick="' + this.objectId + '.execCommand(\'Undo\')"></td>';		html += '   	   <td class="button"><img src="' + this.path + '../images/redo.gif" width="13" height="13" alt="Annuler vers l\'avant" title="Annuler vers l\'avant" onclick="' + this.objectId + '.execCommand(\'Redo\')"></td>';        html += '    	   <td><div class="separator"></div></td>';        //html += '    	   <td class="button"><img src="' + this.path + '../images/anchor.gif" width="13" height="13" alt="Ancre nommé" title="Ancre nommé" onclick="' + this.objectId + '.execCommand(\'CreateBookmark\')"></td>';        //html += '    	   <td class="button"><img src="' + this.path + '../images/link.gif" width="13" height="13" alt="Hyperlien" title="Hyperlien" onclick="' + this.objectId + '.execCommand(\'CreateLink\')"></td>';						html += '   	   <td class="button"><img  src="' + this.path + '../images/cir_0.gif" style="visibility:visible" width="10" height="10" alt="HTML" title="insert code HTML" onclick="var CDHTML = prompt(\'Code HTML : \', \'\');' + this.objectId + '.execCommand(\'insertHTML\',CDHTML)"><br><small><small>HTML</small></small></td>';		        html += '   	   <td><div class="separator"></div></td>';				//' + this.objectId + '.execCommand(\'insertHTML\',tl)html += '    	   <td class="button"><img src="' + this.path + '../images/link.gif" width="10" height="10" alt="Hyperlien" title="Hyperlien Externe" onclick="var tl=lienHyper();' + this.objectId + '.execCommand(\'insertHTML\',tl)"><br><small><small>Ext</small></small></td>';		html += '    	   <td class="button"><img src="' + this.path + '../images/link.gif" width="10" height="10" alt="Hyperlien" title="Hyperlien Interne" onclick="var tl=lienHyper2();' + this.objectId + '.execCommand(\'insertHTML\',tl)"><br><small><small>Int</small></small></td>';			        html += '    	   <td><div class="separator"></div></td>';	html += '    	   <td class="button"><img src="' + this.path + '../images/cir_0.gif" width="10" height="10" alt="Hyperlien" title="Affiche les couche graphique (nappes)" onclick="var tl=CoucheNappe();' + this.objectId + '.execCommand(\'insertHTML\',tl)"><br><small><small>Nappe</small></small></td>';		html += '    	   <td class="button"><img src="' + this.path + '../images/cir_bleu.gif" width="10" height="10" alt="Hyperlien" title="affiche les couches contours SVG" onclick="var tl=CoucheContour();' + this.objectId + '.execCommand(\'insertHTML\',tl)"><br><small><small>Contours</small></small></td>';							        //html += '    	   <td class="button"><img src="' + this.path + '../images/mail.gif" width="13" height="13" alt="Mailto" title="Mailto" onclick="' + this.objectId + '.execCommand(\'Mail\')"></td>';        html += '    	   <td><div class="separator"></div></td>';	  //  html += '    	   <td class="button"><img src="' + this.path + '../images/image.gif" width="13" height="13" alt="Image" title="Image" onclick="' + this.objectId + '.execCommand(\'InsertImage\')"></td>';        //html += '    	   <td><div class="separator"></div></td>';	    html += '    	   <td class="button"><img src="' + this.path + '../images/hr.gif" width="13" height="13" alt="Barre horizontale" title="Barre horizontale" onclick="' + this.objectId + '.execCommand(\'InsertHorizontalRule\')"></td>';		  html += '    	   <td><div class="separator"></div></td>';        html += '    	   <td class="button"><img src="' + this.path + '../images/erase.gif" width="13" height="13" alt="Aucune mise en forme" title="Aucune mise en forme" onclick="' + this.objectId + '.execCommand(\'RemoveFormat\')"></td>';        html += '    	   <td><div class="separator"></div></td>';		//html += '   	   <td class="button"><img src="' + this.path + '../images/cite.gif" width="13" height="13" alt="Citer" title="Citer" onclick="' + this.objectId + '.execCommand(\'Cite\')"></td>';		//html += '   	   <td class="button"><img src="' + this.path + '../images/accronym.gif" width="9" height="9" alt="Acronyme" title="Acronyme" onclick="' + this.objectId + '.execCommand(\'Acronym\')"></td>';		//-------------------------------------------------------------------------------------------------------------------------Inert Cadres FRAMES---------------------------------------------------------------------------------------------------------------------------/*		html += '   	   <td class="button"><img src="' + this.path + 'bg_stripe.png" width="20" height="9" alt="cadre" title="insert cadre " onclick="' + this.objectId + '.execCommand(\'FrameCadre\')"></td>';								var valradar=0				var menuradar='<form name=radar><select style="width:60px;font-size:9px">'				for(i=0;i<listeRADAR.length;i++){													menuradar+='<option style="font-size:9px" onclick="javascript:valradar=this.value;' + this.objectId + '.execCommand(\'FrameRadar\')" value=\''+ listeRADAR[i] +'\'">'+ listeRADAR[i] +'</option>'												}				menuradar+="</select></form>"												html += '   	   <td class="button">'+ menuradar +'</td>';	*/							//-----------------------------------------------------------------------------------------------------------------------FIN de --Inert Cadres FRAMES---------------------------------------------------------------------------------------------------------------------------		//----------------------------------------------------------------------------------------------------------------------Début insert balise de nom---------------------------------------------------------------------------------------------------------------------------				//html += '   	   <td class="button"></td>';							//-----------------------------------------------------------------------------------------------------------------------FIN de insert balise de nom---------------------------------------------------------------------------------------------------------------------------        //html += '    	   <td></td>';       // html += '    	   <td class="button"><img src="' + this.path + '../images/help.gif" width="13" height="13" alt="Help" title="Help" onclick="' + this.objectId + '.openWindow(\'' + this.path + 'test.html\', \'600\', \'600\')"></td>';		html += '  		  </tr>';		html += '		</table>';		html += '	   	</td>';		html += '	   </tr>';		html += '	   <tr>';		html += '	   	<td>';		html += '		<table cellspacing="0" cellpadding="0">';		html += '  		  <tr>';		html += '   	   <td class="button"><img src="' + this.path + '../images/bold.gif" width="15" height="15" alt="Gras" title="Gras" onclick="' + this.objectId + '.execCommand(\'Bold\')"></td>';        html += '   	   <td class="button"><img src="' + this.path + '../images/italic.gif" width="15" height="15" alt="Italique" title="Italique" onclick="' + this.objectId + '.execCommand(\'Italic\')"></td>';        html += '   	   <td class="button"><img src="' + this.path + '../images/underline.gif" width="15" height="15" alt="Souligner" title="Souligner" onclick="' + this.objectId + '.execCommand(\'Underline\')"></td>';		html += '   	   <td class="button"><img src="' + this.path + '../images/strike.gif" width="15" height="15" alt="Barrer" title="Barrer" onclick="' + this.objectId + '.execCommand(\'StrikeThrough\')"></td>';        html += '   	   <td><div class="separator"></div></td>';        html += '   	   <td class="button"><img src="' + this.path + '../images/left.gif" width="15" height="15" alt="Aligner à gauche" title="Aligner à gauche" onclick="' + this.objectId + '.execCommand(\'JustifyLeft\')"></td>';        html += '   	   <td class="button"><img src="' + this.path + '../images/center.gif" width="15" height="15" alt="Centrer" title="Centrer" onclick="' + this.objectId + '.execCommand(\'justifycenter\')"></td>';        html += '   	   <td class="button"><img src="' + this.path + '../images/right.gif" width="15" height="15" alt="Aligner à droite" title="Aligner à droite" onclick="' + this.objectId + '.execCommand(\'JustifyRight\')"></td>';        html += '   	   <td class="button"><img src="' + this.path + '../images/justify.gif" width="15" height="15" alt="Justifier" title="Justifier" onclick="' + this.objectId + '.execCommand(\'JustifyFull\')"></td>';        html += '   	   <td><div class="separator"></div></td>';        html += '    	   <td class="button"><img src="' + this.path + '../images/ul.gif" width="15" height="15" alt="Liste simple" title="Liste simple" onclick="' + this.objectId + '.execCommand(\'InsertUnorderedList\')"></td>';        html += '    	   <td class="button"><img src="' + this.path + '../images/ol.gif" width="15" height="15" alt="Liste numérotée" title="Liste numérotée" onclick="' + this.objectId + '.execCommand(\'InsertOrderedList\')"></td>';        html += '    	   <td><div class="separator"></div></td>';        html += '    	   <td class="button"><img src="' + this.path + '../images/outdent.gif" width="15" height="15" alt="Retrait négatif du texte" title="Retrait négatif du texte" onclick="' + this.objectId + '.execCommand(\'Outdent\')"></td>';        html += '    	   <td class="button"><img src="' + this.path + '../images/indent.gif" width="15" height="15" alt="Retrait du texte" title="Retrait du texte" onclick="' + this.objectId + '.execCommand(\'Indent\')"></td>';        html += '    	   <td><div class="separator"></div></td>';	  	html += '    	   <td class="button"><img src="' + this.path + '../images/bgcolor.gif" width="15" height="15" alt="Couleur de surlignement" title="Couleur de surlignement" onclick="' + this.objectId + '.execCommand(\'BackColor\')"></td>';        html += '    	   <td class="button"><img src="' + this.path + '../images/textcolor.gif" width="15" height="15" alt="Couleur du texte" title="Couleur du texte" onclick="' + this.objectId + '.execCommand(\'ForeColor\')"></td>';        html += '    	   <td><div class="separator"></div></td>';				//html += '<td><table title="lien vers une aire géographique : sélectionnez une aire de la carte puis, après avoir placé le curseur à l\'endroit désiré dans l\'hypertexte, cliquez sur le ien inclus dans ce cadre " onclick="var tl=document.getElementById(\'balisenom\').innerHTML;' + this.objectId + '.execCommand(\'insertHTML\',tl)" style="border:1px solid gray;width:130px;height:18px;background-color:white;font-size:10px"><tr><td id="balisenom" ></td></tr></table></td>'										html += '  		  </tr>';		html += '		</table>';		html += '	   	</td>';		html += '	   </tr>';		html += '	   <tr>';		html += '	   	<td>';		html += '		<table cellspacing="0" cellpadding="0">';		html += '  		  <tr>';		html += '    	   <td>';		html += '    	   <select onchange="' + this.objectId + '.execCommand(\'FormatBlock\', this.value);this.selectedIndex=0;">';		html += '    	    <option value="">Format</option>';		html += '    	    <option value="<p>">Paragraphe</option>';		html += '    	    <option value="<h1>">En-tête 1</option>';		html += '    	    <option value="<h2>">En-tête 2</option>';		html += '    	    <option value="<h3>">En-tête 3</option>';		html += '    	    <option value="<h4>">En-tête 4</option>';		html += '    	    <option value="<h5>">En-tête 5</option>';		html += '    	    <option value="<h6>">En-tête 6</option>';		html += '    	    <option value="<pre>">Pré-formaté</option>';		html += '    	   </select>';		html += '    	   </td>';    	      	   		html += '    	   <td>';		html += '    	   <select style="width:140px" onchange="' + this.objectId + '.execCommand(\'FontName\', this.value);this.selectedIndex=0;">';		html += '    	    <option value="">Police</option>';		html += '    	    <option value="Arial, Helvetica, sans-serif">Arial, Helvetica, sans-serif</option>';		html += '    	    <option value="Times New Roman, Times, serif">Times New Roman, Times, serif</option>';		html += '    	    <option value="Courier New, Courier, mono">Courier New, Courier, mono</option>';		html += '    	    <option value="Georgia, Times New Roman, Times, serif">Georgia, Times New Roman, Times, serif</option>';		html += '    	    <option value="Verdana, Arial, Helvetica, sans-serif">Verdana, Arial, Helvetica, sans-serif</option>';		html += '    	    <option value="Geneva, Arial, Helvetica, sans-serif">Geneva, Arial, Helvetica, sans-serif</option>';		html += '    	   </select>';		html += '    	   </td>';		html += '    	   <td>';		html += '    	   <select onchange="' + this.objectId + '.execCommand(\'FontSize\', this.value);this.selectedIndex=0;">';		html += '    	    <option value="">Taille</option>';		html += '    	    <option value="1">1 (8 pt)</option>';		html += '    	    <option value="2">2 (10 pt)</option>';		html += '    	    <option value="3">3 (12 pt)</option>';		html += '    	    <option value="4">4 (14 pt)</option>';		html += '    	    <option value="5">5 (18 pt)</option>';		html += '    	    <option value="6">6 (24 pt)</option>';		html += '    	    <option value="7">7 (36 pt)</option>';		html += '    	   </select>';		html += '    	   </td>';		html += '  		  </tr>';		html += '		</table>';		html += '	   	</td>';		html += '	   </tr>';		html += ' 	   <tr>';		html += '	  	<td>';		html += '		 <table cellspacing="0" cellpadding="0">';		html += '		   <tr>'; /*       html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-cool.gif" width="18" height="18" alt="Cool" title="Cool" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-cool.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-cry.gif" width="18" height="18" alt="Pleure" title="Pleure" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-cry.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-embarassed.gif" width="18" height="18" alt="Embarassé" title="Embarrassé" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-embarassed.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-foot-in-mouth.gif" width="18" height="18" alt="Mange" title="Mange" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-foot-in-mouth.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-frown.gif" width="18" height="18" alt="Déçus" title="Déçus" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-frown.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-innocent.gif" width="18" height="18" alt="Innocent" title="Innocent" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-innocent.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-laughing.gif" width="18" height="18" alt="Plaisante" title="Plaisante" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-laughing.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-money-mouth.gif" width="18" height="18" alt="Cupide" title="Cupide" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-money-mouth.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-kiss.gif" width="18" height="18" alt="Embrasse" title="Embrasse" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-kiss.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-sealed.gif" width="18" height="18" alt="Muet" title="Muet" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-sealed.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-smile.gif" width="18" height="18" alt="Sourit" title="Sourit" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-smile.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-surprised.gif" width="18" height="18" alt="Surpris" title="Surpris" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-surprised.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-tongue-out.gif" width="18" height="18" alt="Grimace" title="Grimace" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-tongue-out.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-undecided.gif" width="18" height="18" alt="Indécis" title="Indécis" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-undecided.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-wink.gif" width="18" height="18" alt="Clin d\'oeil" title="Clin d\'oeil" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-wink.gif\')"></td>';        html += '		   	<td class="smileys"><img src="' + this.path + '../images/smileys/smiley-yell.gif" width="18" height="18" alt="Aliéné" title="Aliéné" onclick="' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + '../images/smileys/smiley-yell.gif\')"></td>';*//*------------------------------------------AJOUT HP-------------------------------------------------------------------------------------------------------------*/							html += '		   	<span class="smileys"><img  id="cartu" onmousedown="if (event.preventDefault) {event.preventDefault();}return false;" src="' + this.path + 'rouge.png" width="24" height="24" alt="bouton rouge" title="bouton carte" onclick="top.boutonbal(this.id);CursorBefore() ;' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + 'rouge.png?xbalx\');remplaceblancdate();CursorReset()"></span>';//   				html += '		   	<span class="smileys"><img   id="fondu" onmousedown="if (event.preventDefault) {event.preventDefault();}return false;" src="' + this.path + 'vert.png" width="24" height="24" alt="bouton vert" title="bouton fond" onclick="top.boutonbal(this.id);CursorBefore();' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + 'vert.png?xbalx\');remplaceblancdate();CursorReset()"></span>';						html += '		   	<span class="smileys"><img   id="encadru" onmousedown="if (event.preventDefault) {event.preventDefault();}return false;" src="' + this.path + 'jaune.png" width="24" height="24" alt="bouton jaune" title="bouton graphiques encadrés" onclick="top.boutonbal(this.id);CursorBefore();' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + 'jaune.png?xbalx\');remplaceblancdate();CursorReset()"></span>';				html += '		   	<span class="smileys"><img   id="iconu" onmousedown="if (event.preventDefault) {event.preventDefault();}return false;" src="' + this.path + 'bleu.png" width="24" height="24" alt="bouton bleu" title="bouton icones" onclick="top.boutonbal(this.id);CursorBefore();' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + 'bleu.png?xbalx\');remplaceblancdate();CursorReset()"></span>';				html += '		   	<span class="smileys"><img  id="f-ico" onmousedown="if (event.preventDefault) {event.preventDefault();}return false;" src="' + this.path + 'violet.png" width="24" height="24" alt="bouton violet" title="bouton fond et icones" onclick="top.boutonbal(this.id);CursorBefore();' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + 'violet.png?xbalx\');remplaceblancdate();CursorReset()"></span>';				html += '		   	<span class="smileys"><img  id="grille" onmousedown="if (event.preventDefault) {event.preventDefault();}return false;" src="' + this.path + 'papierrrr9cx.jpg" width="24" height="24" alt="bouton grille" title="bouton Icone Y et grille" onclick="calculNbGrilles();CursorBefore();' + this.objectId + '.execCommand(\'InsertImage\', \'' + this.path + 'papierrrr9cx.jpg?\'+nbimgBi);remplaceblancdate2();CursorReset()" style="visibility:hidden"  onmouseover="activeIconeYbouton()"></span>';				/*------------------------------------------FIN AJOUT HP-------------------------------------------------------------------------------------------------------------*/							html += '		   </tr>';		html += '		 </table>';		html += '	  	</td>';		html += ' 	   </tr>';		html += '	 </table>';		html += '	</td>';		html += '  </tr>';		html += '  <tr>';		html += '	<td class="frame"><iframe id="' + this.id + '-frame" style="height:' + this.height + '; width:' + this.width + '"></iframe></td>';		html += '  </tr>';        html += '  <tr>';		html += '   <td class="source"><span style="visibility:hidden;width:0px"><input id="' + this.id + '-viewSource" type="checkbox" onclick="' + this.objectId + '.toggleSource()"> Source<input type="text" style="visibility:hidden;width:2px" id="N[4]" name="N[4]" ></span></td>';				html += '  </tr>';        html += '</table>';        return html;    };    this.getFrameHtml = function() {	        var html = '';		html += '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';		html += '<html xmlns="http://www.w3.org/1999/xhtml">';		html += '<head>'		//html += '<script type="text/javascript">var choixcarte=0</script><script language="javascript" src="metalanguage.js"></script>';		html += '<meta http-equiv="Content-Type" content="text/html; charset=' + this.charset + '" />';		html += '<title>Wysiwyg editor</title>';		if (this.cssFile) { 		html += '<link rel="stylesheet" type="text/css" href="' + this.cssFile + '">'; 		}		html += '<style type="text/css">';		html += 'html, body {'; 		html += '	cursor: text;'; 		html += '}';		html += 'body {';		html += '	margin: 0.5em; ';		html += '	padding: 0;';		html += '}';		html += '</style>';		html += '</head>';		html += '<body>';		//html += '<script>function xxx(){carte();fond();icone();fi();encadre();balayagenodes();};xxx()<script>';				html += '</body>';		html += '</html>';        return html;    };    this.execCommand = function(cmd, value) {		try {			this.frame.focus();			if (cmd == 'CreateLink' && !value) {				var url = prompt('Entrer l\'URL du lien', 'http://');				if (url) {					this.frame.document.execCommand('Unlink', false, null);					if (this.browser.ie) 						this.frame.document.execCommand(cmd, false, 'wysiwyg://wysiwyg/' + url);					else if (this.browser.gecko) 						this.frame.document.execCommand(cmd, false, url);				}			} 					else if (cmd == 'Mail' && !value) {				var text = prompt('Texte : ', 'E-mail');				var mail = prompt('Adresse de Messgaerie : ', 'xxxx@xxxx.xxx');				if(text && mail) {					self.frame.document.body.innerHTML += '<a href="mailto:' + mail + '">' + text + '</a>';				}			} 				else if (cmd == 'Undo' ) {								this.frame.document.execCommand(cmd,false,'')			}			else if (cmd == 'Redo' ) {								this.frame.document.execCommand(cmd,false,'')			}						else if (cmd == 'InsertImage' && !value) {				var imageUrl = prompt('Entrer l\'URL de l\'image : ', 'http://');								if (imageUrl) {					this.frame.document.execCommand(cmd, false, imageUrl );									}			} 						else if (cmd == 'BackColor' && !value) {				var BackColor = prompt('Entrer la couleur Hexadecimal de surlignement : ', '#');				if (BackColor) {					this.frame.document.execCommand(cmd, false, BackColor);				}			} 			else if (cmd == 'ForeColor' && !value) {				var ForeColor = prompt('Entrer la couleur Hexadecimal du texte : ', '#');				if (ForeColor) {					this.frame.document.execCommand(cmd, false, ForeColor);				}			} 			else if (cmd == 'Cite' && !value) {				var author = prompt('Auteur : ', '');				var cite = prompt('citation : ', '');				if(author && cite) {					self.frame.document.body.innerHTML += '<blockquote title="' + author + '">' + cite + '</blockquote>';				}			} 			else if (cmd == 'Acronym' && !value) {				var acronym = prompt('Acronyme : ', '');				var definition = prompt('Définition : ', '');				if(acronym && definition) {					self.frame.document.body.innerHTML += '<acronym title="' + definition + '">' + acronym + '</acronym>';				}			} 			// ------------------------------------------------------------------------------------------------------------------------------------------------FRAME cadre-------------------------------------------------------------			else if (cmd == 'FrameCadre' && !value) {			var nbframe=document.getElementsByTagName('iframe')[0].contentWindow.document.body.getElementsByTagName('iframe').length			var Framecadre = prompt('Entrer l\'URL du du fichier encadré', 'http://');				if (Framecadre) {	self.frame.document.body.innerHTML +='<br><table style="border:0.5px dotted black"><tr ><td><iframe id="cadre'+ (nbframe+1) +'" name="cadre'+ (nbframe+1) +'" width="100%" height="100%" frameborder=0 scrolling="yes"></iframe><script>var ad="'+ Framecadre +'";window.frames.cadre'+ (nbframe+1) +'.location.href=ad</script></td></tr></table><br>'				}			} 			// ----------------------------------------------------------------------------------------------------------------------------------------Fin de FRAME cadre-------------------------------------------------------------			// ------------------------------------------------------------------------------------------------------------------------------------------------FRAME RADAR-----------------------------------------------------------			else if (cmd == 'FrameRadar' && !value) {			var nbframe=document.getElementsByTagName('iframe')[0].contentWindow.document.body.getElementsByTagName('iframe').length												var Framecadre = "../RADARHypertexte/radarparrain.xml?radar=rad/"+valradar;				if (Framecadre) {	self.frame.document.body.innerHTML +='<br><center<table style="border:0.5px dotted black;width:250px;height:265px"><tr ><td><iframe id="cadre'+ (nbframe+1) +'" name="cadre'+ (nbframe+1) +'" width="100%" height="100%" frameborder=0 scrolling="no"></iframe><script>var ad="'+ Framecadre +'";window.frames.cadre'+ (nbframe+1) +'.location.href=ad</script></td></tr></table></center><br>'				}			} 			// ----------------------------------------------------------------------------------------------------------------------------------------Fin de FRAME RADAR------------------------------------------------------------			else {if( this.browser.ie & cmd=="insertHTML"){//alert("cccc")value=" "+valuevar sel = document.selection.createRange();if (sel!=null)sel.pasteHTML(value);//sel.select();}else{				this.frame.document.execCommand(cmd, false, value);	 }									}			this.frame.focus();		}		catch(e) {			alert(e); 		}    };    this.openWindow = function(url, width, height) {        var x = (screen.width/2-width/2);        var y = (screen.height/2-height/2);		        window.open(url, '', 'scrollbars=yes, width=' + width + ', height=' + height + ', screenX=' + (x) + ', screenY=' + y + ', left=' + x + ', top=' + y);    };    this.toggleSource = function() {        var html, text;        if (this.browser.ie) {            if (!this.viewSource) {                html = this.frame.document.body.innerHTML;                this.frame.document.body.innerText = unlockUrls(html);                document.getElementById(this.id + '-buttons').style.visibility = 'hidden';                this.viewSource = true;				boutonhidden();            } 			else {                text = this.frame.document.body.innerText;                this.frame.document.body.innerHTML = lockUrls(text);                document.getElementById(this.id + '-buttons').style.visibility = 'visible';                this.viewSource = false;				boutonvisible();            }        } 		else if (this.browser.gecko) {            if (!this.viewSource) {                html = document.createTextNode(this.frame.document.body.innerHTML);                this.frame.document.body.innerHTML = '';                this.frame.document.body.appendChild(html);                document.getElementById(this.id + '-buttons').style.visibility = 'hidden';                this.viewSource = true;				boutonhidden();            } 			else {                html = this.frame.document.body.ownerDocument.createRange();                html.selectNodeContents(this.frame.document.body);                this.frame.document.body.innerHTML = html.toString();                document.getElementById(this.id + '-buttons').style.visibility = 'visible';                this.viewSource = false;				boutonvisible();            }        }        document.getElementById(this.id + '-viewSource').checked = this.viewSource ? 'checked' : '';        document.getElementById(this.id + '-viewSource').blur();    };		this.isOn = function() {	        return Boolean(this.frame);    };    this.getContent = function() {        try { 			return unlockUrls(this.frame.document.body.innerHTML); 		} 		catch(e) {			alert(e); 		}    };    this.submit = function() {        if (this.isOn()) {            if (this.viewSource) 				this.toggleSource(); 				            document.getElementById(this.id).value = this.getContent();        }    };}