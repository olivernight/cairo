<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Script-Type" content="text/javascript">
  <meta http-equiv="expires" content="0">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content=" no-cache, max-age:10, must-revalidate">
    <meta http-equiv="cache-control" content="no-store">
<!--style>
a.lienmenu:link { color:black;}
a.lienmenu:visited { color:black;}
</style-->
	<script type="text/javascript">
	var listUtil=new Array()
	</script>
	<script language="javascript" src="hypertexte.js"></script>
	<script  type="text/javascript" src="http://altko.org/altercarto/visionneuse/A-MANAGER-local/Utilisateurs/listeUtil.js"></script>
	<script  type="text/javascript" src="A-MANAGER-local/Utilisateurs-DISCUSSION/listeUtil.js"></script>
	<script type="text/javascript">
var blocage=0
var pseudo=""
var contact=""

    var urlvar=''
    
    if (window.location.search != '') {
    longueur = window.location.search.length - 1;
    
    data = window.location.search.substr(1,longueur);
    donnees = data.split('&');
    urlvar = new Array();
    urlvarnum = new Array();
    for (var i=0; i < donnees.length; i++) {
    position = donnees[i].indexOf('=');
    variable = donnees[i].substr(0,position);
    pos = position + 1;
    valeur = decodeURI(donnees[i].substr(pos,donnees[i].length));
    while (valeur.search(/\+/) != -1)
    valeur = valeur.replace(/\+/,' ');
    urlvar[variable] = valeur;
    urlvarnum[i] = valeur;
    }
    }
var discut=urlvar['discut']

function getScrollPosition()
{
	return Array((document.documentElement && document.documentElement.scrollLeft) || window.pageXOffset || self.pageXOffset || document.body.scrollLeft,(document.documentElement && document.documentElement.scrollTop) || window.pageYOffset || self.pageYOffset || document.body.scrollTop);
}
var Xscroll=0
var NoDatX=0
function positionScroll(){
//window.frames.discuss.document.body.scrollTop=Xscroll
//setTimeout('window.frames.discuss.versbas()',100)
//setTimeout('window.frames.discuss.location.href="'+discut+'/'+discut+'.html#bas"',100)

}
var Xscrolling=0
function inscroll(){ Xscrolling=1; 
//document.getElementById("test").innerHTML=Xscrolling
}
function outscroll(){ Xscrolling=0; 
//document.getElementById("test").innerHTML=Xscrolling
}
function affectEventScroll(){

document.getElementById("discuss2").setAttribute("onmousedown","inscroll()")
document.getElementById("discuss2").setAttribute("onmouseup","outscroll()")
}
var cpt=0
var TextInner=""
var TextUploadedInner=""

							var urlIci=window.location.href
							var fileIci=urlIci.split('/')[urlIci.split('/').length-1]
							var repIci=urlIci.replace(fileIci,"")
							fileIci=fileIci.split('?')[0]
							
							
							

function rien(){}
function recharge(){

if(Xscrolling==0 & blocage==0){

TextInner=document.getElementById("discuss2").innerHTML
var FrameDiscussInner=window.frames.discuss.document.body.innerHTML
//alert(FrameDiscussInner)
var ArrayImgDiscuss=new Array()
var nbImgDiscuss=window.frames.discuss.document.getElementsByTagName("img").length
for(j=0;j<nbImgDiscuss;j++){
var imgOrigine=window.frames.discuss.document.getElementsByTagName("img")[j].src.replace(repIci,"")

ArrayImgDiscuss[ArrayImgDiscuss.length]=imgOrigine
FrameDiscussInner=FrameDiscussInner.replace(imgOrigine.replace("PageCarto/",""),imgOrigine)

}


FrameDiscussInner=FrameDiscussInner.replace(/="info\//g,'="PageCarto/info/')
FrameDiscussInner=FrameDiscussInner.replace(/='info\//g,"='PageCarto/info/")




if(FrameDiscussInner.length!=TextInner.length ){

document.getElementById("discuss2").innerHTML=FrameDiscussInner ;

var nbImgIci=document.getElementsByTagName("img").length

for(j=0;j<nbImgIci;j++){
//if(document.getElementsByTagName("img")[j].src.replace(repIci,"")==ArrayImgDiscuss[j]){;document.getElementsByTagName("img")[j].src=ArrayImgDiscuss[j]}
}


document.getElementById("discuss2").scrollTop="30000";if(NoDatX==0){parent.NoDatXici(1);NoDatX=1}}

TextUploadedInner=document.getElementById("uploaded2").innerHTML
var FrameUploadedInner=window.frames.uploaded.document.body.innerHTML



if(FrameUploadedInner.length!=TextUploadedInner.length & FrameUploadedInner.length>0 ){
document.getElementById("uploaded2").innerHTML=FrameUploadedInner;

}

cpt+=1
Xscroll=window.frames.discuss.document.body.scrollTop

setTimeout('affectEventScroll()',50)

setTimeout('recharge2()',2500)
}else{setTimeout('recharge()',100)}
}
function recharge2(){
//window.frames.uploaded.location.href="vide.html"
//window.discuss.location.href="vide.html" 
setTimeout('recharge3()',5)
}
function recharge3(){
//window.discuss.location.href=discut+"/"+discut+".html"  

setTimeout('recharge4()',50)
}

function recharge4(){
//window.frames.uploaded.location.href=discut+"/ListeDocs.html"

}

function envoi(){
var textmessage=document.getElementById("message0").value

//
textmessage=textmessage.replace(/\n/g,"<br/>")
textmessage=textmessage.replace(/>/g,"**gt**")
textmessage=textmessage.replace(/</g,"**lt**")

if(document.getElementById("message0").value!=""){
blocage=0
document.getElementById("B_2").checked="true"
document.getElementById("message").innerHTML=textmessage
document.getElementById("message0").value=""

document.contrib.submit()

setTimeout('recharge2()',500)
}
}
var redem=window.location.href
function aller0(){
pseudo=urlvar["pseudo"]
contact=urlvar["contactX"]
redem=window.location.href
aller2()
}
function aller(){
pseudo=document.getElementById("loginadh").value
contact=document.getElementById("email").innerHTML
redem=window.location.href+"&pseudo="+pseudo+"&contactX="+contact
aller2()
}
function aller2(){
/*
var testmail=contact.replace(/ /g,"")
var testmail2=contact.split('@')
if(testmail2[1]){
if(testmail2[1].indexOf(".")>=0){var testici=1}else{var testici=0}
}else{
if( testmail==""){var testici=1}else{var testici=0}}

if(testici==0){
document.getElementById("mesloginadh").innerHTML="<br/>Désolé,votre adresse mail n'est pas conforme"
}else
*/
{
document.getElementById("mesloginadh").innerHTML="<br/>"
if(pseudo.replace(/ /g,"")==""){
document.getElementById("loginadh").value=""
document.getElementById("mesloginadh").innerHTML="Indiquez un avatar ou annulez votre participation"
document.getElementById("annul").style.display="block"
}else{
document.getElementById("pseudo").value=pseudo
document.getElementById("contact").value=contact
document.getElementById("pseudobis").innerHTML="<b>Votre avatar</b>="+pseudo
document.getElementById("contactbis").innerHTML="<b>e-mail</b>="+contact
document.getElementById("annul").style.display="none"
document.getElementById("mesloginadh").innerHTML="&nbsp;&nbsp;"
document.getElementById("coord").style.display="none"
document.getElementById("contrib").style.display="block"
document.getElementById("SearchToUpload").style.display="block"
chargeModuleUpload()
}
}
}
function chargeModuleUpload(){
var quiici=document.getElementById("pseudo").value
var contactici=document.getElementById("contact").value
//var titreici=urlvar['titre'].replace(/\'/g,"x@x")
//var objetici=urlvar['objet'].replace(/\'/g,"x@x")
blocage=0
document.getElementById("B_2").checked="true"
recharge2()
//alert("discut="+discut+"&qui="+quiici+"&contact="+contactici+"&titre="+titreici+"&objet="+objetici)
window.SearchToUpload.location.href="download.php?discut="+discut//+"&qui="+quiici+"&contact="+contactici+"&titre="+titreici+"&objet="+objetici

}

var util=""
var indicValidTestCoord=0
function testCompte(){
document.getElementById('mesloginadh').innerHTML=""
document.getElementById('mesmo2pasadh').innerHTML=""

a=document.getElementById('loginadh').value
b=document.getElementById('mo2pasadh').value
var testa=1
var testb=1
var rga=""
var rgb=""
for(i=0;i<listUtil.length;i++)
{
if(a==listUtil[i][0]){testa=0}
if(b==listUtil[i][1]){testb=0}
if(testa==0 & testb==0){Xemail=listUtil[i][2];document.getElementById('email').innerHTML=Xemail;i=listUtil.legnth}

}

if(testa==1){document.getElementById('mesloginadh').innerHTML="login inexistant"}
if(testb==1 & testa==0){document.getElementById('mesmo2pasadh').innerHTML="mot de passe érroné"}
if(testa==1 || testb==1){indicValidTestCoord=0}else{

util=a
indicValidTestCoord=1;
poursuivre()}

}
var Xemail=""
function enregistreCompte(){
Xemail=""
document.getElementById('messageenreg').innerHTML=""
a=document.getElementById('login').value
//test sur le login ( stop s'il existe déjà)
var testa=1
var testc1=1
var testc2=1
for(i=0;i<listUtil.length;i++)
{
if(a==listUtil[i][0]){testa=0}
}
if(testa==1){
b=document.getElementById('mo2pas').value
c=document.getElementById('adresmail').value
if(a!="" &  b!=""  & c!="" ){

//test sur la conformité de l'adresse
var ctab=c.split('@')
if(ctab.length==2){
if(ctab[1].indexOf(".")>0){Xemail=c;document.getElementById('email').innerHTML=Xemail}else{var testc2=0}
}else{testc1=0}
if( testc1==0 || testc2==0){document.getElementById('messageenreg').innerHTML="adresse non conforme"
}else{
util=a
indicValidTestCoord=1
document.getElementById("loginadh").value=a
InscriptListeDiscutant(a,b,c)

}
}else{
document.getElementById('messageenreg').innerHTML="Coordonnées incomplètes"
}
}else{document.getElementById('messageenreg').innerHTML="Ce login existe déjà!"}
}

function InscriptListeDiscutant(a,b,c){
//alert("util="+a+"&mp="+b+"&ad="+c)
window.frames.execCompte.location.href="A-MANAGER-local/Utilisateurs-DISCUSSION/creaCompte.php?util="+a+"&mp="+b+"&ad="+c
poursuivre()

}

function poursuivre(){

if(indicValidTestCoord==1)
{
// avec compte valide 
aller()
//window.location.href="readLibelDATA-REC-MODULE.html?util="+util
}else{
// sans compte
//window.location.href="readLibelDATA-REC-MODULE.html?util="
}
}


function FormAction(){
var utilici=document.getElementById('pseudo').value
var contactici=document.getElementById('contact').value
var messageici=document.getElementById('message').innerHTML
var discussionici=document.getElementById('discussion').value
var titreici=urlvar['titre']
var objetici=urlvar['objet']



window.frames.execCompte.location.href='ajoutMessage.php?util='+utilici+'&contact='+contactici+'&message='+messageici+'&discussion='+discussionici+'&titre='+titreici+'&objet='+objetici
}
</script>
<head>
<body style="font-family:arial; font-size:10px" >
<span id="test"></span><span id="test2"></span>

<table style="font-family:arial; width:440px;font-size:11px">
<tr>
<td style="text-align:center">
<div style="display:none">
<b><big><big style="display:none;color:navy">Discussion : <span id="titrediscut"> </span></big></big></b>
<br/>

<b><span id="objetdiscut" style="color:navy"> </span></b><br/>
<center><dt><span id="pseudobis"></span>&nbsp;&nbsp;<span id="contactbis"></span></dt><dt><input type="button" value="rafraichir" onclick="window.location.href=redem"></input></dt></center>
</div>

</td>
<td>

</td>
</tr>
<tr>
<td>

</td>

</tr>

<tr>
<td>
<table><tr><td>
<div id="discuss2" name="discuss2" style="width:400px;height:190px;border:1px solid gray;overflow:scroll;background-color:rgb(228, 228, 228);font-size:10px"   >  </div>
<span id="frameDiscuss">
<iframe id="discuss" name="discuss" style="width:400px;height:190px;border:0.5px solid gray;display:none"   onUnload="rien()"></iframe>
</span>
</td>
<td width=100>

<center>
<a style="color:#6C8CBE" href="../../IndexDuManuel/C PageCarto/6_Module PageCarto Collaboratif.pdf" target="_blank"><b>Manuel</b></a>
<a style="color:#6C8CBE" href="COPYING GNU.txt" target="_blank"><b><small>GNU GPL</small></b></a>

<dt style="color:gray">_________</dt>
<dt>Versions</dt>

<dt><a style="color:#6C8CBE" href="Normal.html" target="_blank" >Normale</a></dt>
<dt><a style="color:#6C8CBE" href="version-pour-fouiller.html" target="_blank">Fouillée</a></dt>
<dt><a style="color:#6C8CBE" href="GRAND pour Firefox.html" target="_blank">Grande</a></dt>
<dt><a style="color:#6C8CBE" href="REDUIT.html" target="_blank">Réduite</a></dt>

<dt style="color:gray">_________</dt>
<small><dt><input type="radio" name="B" onclick="blocage=1"><span id="blo" ><br/>Bloquer<br/>le flux </span> </dt><dt><input type="radio" id="B_2" name="B" checked="true" onclick="blocage=0;recharge3()"><span id="deblo" ><br/>Débloquer </span></dt></small>
</center>
<div id="uploaded2" name="uploaded2" style="display:none;width:190px;height:300px;overflow:scroll;border:1px solid gray"  >  </div>
<iframe id="uploaded" name="uploaded" style="display:none;width:190px;height:300px;overflow:scroll;border:0.5px solid gray;"  onload="positionScroll();setTimeout('recharge()',300)"   onUnload="rien()" ></iframe>
</td></tr></table>
</td>
</tr>
<tr>
<td style="text-align:left">

<center id="coord" style="display:block">

<dt id="email" style="display:none"> </dt>
<center>
<span id="visit">

<span id="adh" style="text-align:left;display:bloc"><!--span style="font-weight: bold;">Vos coordonnées</span-->
<table style="font-family: arial; font-size: 11px; text-align: center;background-color:rgb(228, 228, 228);width:410px">
  <tbody>
    <tr>
      <td style="color: red; font-weight: bold;" id="mesloginadh">
      </td>
      <td style="color: red; font-weight: bold;" id="mesmo2pasadh">
      </td>
    </tr>
    <tr>
      <td>Login<br>
      <input id="loginadh" style="width: 150px;" type="text" onkeydown="document.getElementById('mesloginadh').innerHTML='&nbsp;&nbsp;'"><br><input value="OK" onclick="testCompte()" type="button"> </td>
      <td>Mot de passe<br>
      <input id="mo2pasadh" style="width: 150px;" type="text" onkeydown="document.getElementById('mesmo2pasadh').innerHTML='&nbsp;&nbsp;'"><br><input id="annul"  value="Annuler" onclick="window.close()" type="button"> </td>
    </tr>
	<!--tr>
	<td>
  
	</td>
	<td>
  
      </td>
	  </tr-->
  </tbody>
</table>

<center>
<table style="font-family: arial; font-size: 11px; text-align: center;">
  <tbody>
    <tr>
      <td> <input value="Créer un Compte"
 onclick="document.getElementById('adh').style.display='none';document.getElementById('enreg').setAttribute('style','bloc')"
 type="button">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--  --></td> 
      <td  style="display:none"> <input value="Poursuivre sans compte"
 onclick="indicValidTestCoord=0;poursuivre()" type="button"></td>
    </tr>
  </tbody>
</table>
</center>
</span>
<!-- ///////////////////////////////////////////////////// fin d'adhérent //////////-->
<!-- /////////////////////////////////////////////////////enregistrement //////////-->
<span id="enreg" style="display:none"><span style="font-weight: bold;display:none">Enregistrez
vous</span>
<table style="font-family: arial; font-size: 11px; text-align: center;">
  <tbody>
    <tr>
      <td style="color: red; font-weight: bold;" id="messageenreg"><br>

      </td>
    </tr>
  </tbody>
</table>
<span id="visit" style="text-align:center">
<table style="background-color:rgb(228, 228, 228);width:410px">
  <tbody>
    <tr>
      <td>
      <div style="text-align: center;"><small>Login</small><br>
      </div>
      <input id="login" style="width: 100px;" type="text"> <br>
      </td>
      <td>
      <div style="text-align: center;"><small>Mot de passe</small><br>
      </div>
      <input id="mo2pas" style="width: 100px;" type="text"> <br>
      </td>
      <td>
      <div style="text-align: center;"><small>Adresse mail</small><br>
      </div>
      <input id="adresmail" style="width: 150px;" type="text"> <br>
      </td>
    </tr>    
	<tr >
      <td></td><td style="text-align: right;">
	  <input value="OK" onclick="enregistreCompte()" type="button">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      <!-- --></td>
      <td style="display:none"><input   value="Poursuivre sans compte" 
 onclick="indicValidTestCoord=0;poursuivre()" type="button">
      
	  
	  </td>
    </tr>
  </tbody>
</table>


<table style="font-family: arial; font-size: 11px; text-align: center;width:390px">
  <tbody>
<tr><td>
<input value="Revenir en arrière"
 onclick="document.getElementById('adh').setAttribute('style','bloc');document.getElementById('enreg').style.display='none'" type="button">  
</td></tr>
  </tbody>
</table>

</span>
<!-- ///////////////////////////////////////////////////// fin d'enregistrement //////////--><br>
<br>
</span>
</span>
</center>
<br>
<br>
<br>

<!--/span></center-->
</td>

</tr>
<tr>
<td>

<span id="InF">

<form name="contrib" id="contrib" action="javascript:FormAction()" style="display:none">
<table><tr><td>
<dt style="border:1px solid gray">
<input style="display:none" id="pseudo" name="N[0]" value="" /><input style="display:none"  id="contact" name="C[0]" value="" /><input style="display:none"  id="discussion" name="F[0]" value="" />
<input style="display:none" id="Titre0" name="T[0]" value="Hervé" />
<input style="display:none" id="Object0" name="O[0]" value="Hervé" />
<textarea id="message0"  style="border:0px;width:400px;height:100px;overflow:scroll"></textarea><br/>
<textarea id="message" name="M[0]" style="width:400px;height:100px;display:none"></textarea>
</dt>

</td><td>

<center> <input type="button" onclick="envoi()" value="envoyer" />  </center>

<form>
<span style="vertical-align:top;display:none">
<iframe  id="SearchToUpload" name="SearchToUpload" style="width:190px;height:109px;;border:1px solid gray;display:none" scrolling="no" ></iframe>

</span>
</span>
</td>

</tr>
</table><br/>
<!--small><small style="color:gray"><b>réalisé par <a href="mailto:cite.publique@wanadoo.fr" style="color: gray">Cité Publique</a> - Copyleft H.Paris 2011 - GNUGPL</b></small></small -->

<script type="text/javascript">
window.frames.uploaded.location.href="PageCarto/ListeDocs.html"

document.getElementById("message").value=""
document.getElementById("discussion").value=discut
/*
document.getElementById("titrediscut").innerHTML=urlvar['titre']
document.getElementById("objetdiscut").innerHTML=urlvar['objet'].replace('@@@@1','<a href=mailto:"').replace('@@@@2','">').replace('@@@@3','</a>')
document.getElementById("Titre0").value=urlvar['titre']
document.getElementById("Object0").value=urlvar['objet']
*/
if(window.location.href.indexOf("&log=")>0){

if(urlvar['log'].replace(/ /g,"").length>0){
document.getElementById("pseudo").value=urlvar['log']
document.getElementById("contact").value=urlvar['mail']
document.getElementById("pseudobis").innerHTML="<b>Votre avatar</b>="+urlvar['log']
document.getElementById("contactbis").innerHTML="<b>e-mail=</b>"+urlvar['mail']
document.getElementById("coord").style.display="none"
document.getElementById("contrib").style.display="block"
document.getElementById("SearchToUpload").style.display="block"
chargeModuleUpload()
}
}

function rec(){
window.rechargeEnboucle.location.href="recharge.php?discut="+discut+"&ran="+Math.random()
}

document.write('<iframe id="execCompte" name="execCompte" style="display: none;"></iframe>')
document.write('<iframe  id="rechargeEnboucle" name="rechargeEnboucle" src="recharge.php?discut='+discut+'" style="width:190px;height:109px;;border:1px solid gray;display:none" onload="setTimeout(\'rec()\',3000)" scrolling="no" ></iframe>')
document.getElementById("message0").value=''
//window.discuss.location.href=discut+"/"+discut+".html"

if(urlvar["pseudo"]){aller0()}
//recharge()
</script>

</body>
</html>